{"ast":null,"code":"var _jsxFileName = \"/Users/luked/Documents/slnsw/dxlab-art-index/components/BubbleChart/BubbleChart.tsx\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport * as d3 from 'd3';\nimport render from 'd3-render';\nimport useDimensions from '../../lib/hooks/use-dimensions';\nimport css from './BubbleChart.module.scss';\n\nconst BubbleChart = (_ref) => {\n  let {\n    data = [],\n    height = 200,\n    // width = 200,\n    bubblePadding = 3,\n    className,\n    renderBubble,\n    renderLabel,\n    onBubbleClick,\n    showValues = true\n  } = _ref,\n      restProps = _objectWithoutProperties(_ref, [\"data\", \"height\", \"bubblePadding\", \"className\", \"renderBubble\", \"renderLabel\", \"onBubbleClick\", \"showValues\"]);\n\n  const [hoverIndex, setHoverIndex] = React.useState(null);\n  const [svgRef, dimensions, svgNode] = useDimensions();\n  const {\n    width\n  } = dimensions;\n  React.useEffect(() => {\n    // console.log(onBubbleClick);\n    if (svgNode && data.length > 0 && width) {\n      const root = pack(data, {\n        width,\n        height,\n        padding: bubblePadding\n      });\n      const circleData = root.leaves().map((d, i) => {\n        if (typeof renderBubble === 'function') {\n          return renderBubble(d, i);\n        }\n\n        return {\n          append: 'g',\n          transform: `translate(${d.x},${d.y})`,\n          children: [{\n            append: 'circle',\n            data: d.data,\n            r: d.r,\n            fill: 'var(--colour-primary)',\n            onClick: onBubbleClick,\n            onMouseOver: () => {\n              setHoverIndex(i);\n            },\n            onMouseOut: () => {\n              setHoverIndex(null);\n            }\n          }]\n        };\n      });\n      const textData = root.leaves().map((d, i) => {\n        const isHovered = i === hoverIndex;\n\n        if (typeof renderLabel === 'function') {\n          return renderLabel(d, i);\n        }\n\n        return {\n          append: 'g',\n          transform: `translate(${d.x},${d.y})`,\n          children: [{\n            append: 'text',\n            key: `${isHovered}`,\n            fill: 'var(--colour-white)',\n            text: showValues || isHovered ? d.data.name : '',\n            y: (_, index, node) => `${index - node.length / 2 + 0.8}em`\n          }]\n        };\n      });\n      const renderData = [...circleData, ...textData];\n      render(svgNode, renderData);\n    }\n  }, [svgNode, data, width, height, bubblePadding, renderBubble, renderLabel, onBubbleClick, showValues, hoverIndex]);\n  return __jsx(\"svg\", _extends({\n    ref: svgRef,\n    width: width,\n    height: height,\n    className: [css.bubbleChart, className || ''].join(' ')\n  }, restProps, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 5\n    }\n  }));\n};\n\nfunction pack(data, {\n  width,\n  height,\n  padding\n}) {\n  return d3.pack().size([width - 2, height - 2]).padding(padding)(d3.hierarchy({\n    children: data\n  }).sum(d => d.value));\n}\n\nBubbleChart.propTypes = {\n  className: PropTypes.string\n};\nexport default BubbleChart;","map":{"version":3,"sources":["/Users/luked/Documents/slnsw/dxlab-art-index/components/BubbleChart/BubbleChart.tsx"],"names":["React","PropTypes","d3","render","useDimensions","css","BubbleChart","data","height","bubblePadding","className","renderBubble","renderLabel","onBubbleClick","showValues","restProps","hoverIndex","setHoverIndex","useState","svgRef","dimensions","svgNode","width","useEffect","length","root","pack","padding","circleData","leaves","map","d","i","append","transform","x","y","children","r","fill","onClick","onMouseOver","onMouseOut","textData","isHovered","key","text","name","_","index","node","renderData","bubbleChart","join","size","hierarchy","sum","value","propTypes","string"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport * as d3 from 'd3';\nimport render from 'd3-render';\n\nimport useDimensions from '../../lib/hooks/use-dimensions';\n\nimport css from './BubbleChart.module.scss';\n\ntype Props = {\n  data: {\n    name: string;\n    value: number;\n  }[];\n  height?: number;\n  // width?: number;\n  bubblePadding?: number;\n  className?: string;\n  renderBubble?: Function;\n  renderLabel?: Function;\n  onBubbleClick?: Function;\n  showValues?: boolean;\n};\n\nconst BubbleChart: React.FC<Props> = ({\n  data = [],\n  height = 200,\n  // width = 200,\n  bubblePadding = 3,\n  className,\n  renderBubble,\n  renderLabel,\n  onBubbleClick,\n  showValues = true,\n  ...restProps\n}) => {\n  const [hoverIndex, setHoverIndex] = React.useState(null);\n  const [svgRef, dimensions, svgNode] = useDimensions();\n  const { width } = dimensions;\n\n  React.useEffect(() => {\n    // console.log(onBubbleClick);\n\n    if (svgNode && data.length > 0 && width) {\n      const root = pack(data, { width, height, padding: bubblePadding });\n\n      const circleData = root.leaves().map((d, i) => {\n        if (typeof renderBubble === 'function') {\n          return renderBubble(d, i);\n        }\n\n        return {\n          append: 'g',\n          transform: `translate(${d.x},${d.y})`,\n          children: [\n            {\n              append: 'circle',\n              data: d.data,\n              r: d.r,\n              fill: 'var(--colour-primary)',\n              onClick: onBubbleClick,\n              onMouseOver: () => {\n                setHoverIndex(i);\n              },\n              onMouseOut: () => {\n                setHoverIndex(null);\n              },\n            },\n          ],\n        };\n      });\n\n      const textData = root.leaves().map((d, i) => {\n        const isHovered = i === hoverIndex;\n        if (typeof renderLabel === 'function') {\n          return renderLabel(d, i);\n        }\n\n        return {\n          append: 'g',\n          transform: `translate(${d.x},${d.y})`,\n          children: [\n            {\n              append: 'text',\n              key: `${isHovered}`,\n              fill: 'var(--colour-white)',\n              text: showValues || isHovered ? d.data.name : '',\n              y: (_, index, node) => `${index - node.length / 2 + 0.8}em`,\n            },\n          ],\n        };\n      });\n\n      const renderData = [...circleData, ...textData];\n      render(svgNode, renderData);\n    }\n  }, [\n    svgNode,\n    data,\n    width,\n    height,\n    bubblePadding,\n    renderBubble,\n    renderLabel,\n    onBubbleClick,\n    showValues,\n    hoverIndex,\n  ]);\n\n  return (\n    <svg\n      ref={svgRef}\n      width={width}\n      height={height}\n      className={[css.bubbleChart, className || ''].join(' ')}\n      {...restProps}\n    />\n  );\n};\n\nfunction pack(data, { width, height, padding }) {\n  return d3\n    .pack()\n    .size([width - 2, height - 2])\n    .padding(padding)(d3.hierarchy({ children: data }).sum((d) => d.value));\n}\n\nBubbleChart.propTypes = {\n  className: PropTypes.string,\n};\n\nexport default BubbleChart;\n"]},"metadata":{},"sourceType":"module"}