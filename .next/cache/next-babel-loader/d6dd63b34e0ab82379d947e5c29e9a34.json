{"ast":null,"code":"import * as d3 from 'd3';\nexport async function getExhibitionDetail(host, id) {\n  // TODO: Work out https or http\n  const allExhibitions = await d3.csv(`http://${host}/art-index/data/exhibitions.csv`);\n  const exhibition = allExhibitions.find(e => e.id === id);\n  return exhibition;\n}\n\nasync function handler(req, res) {\n  const {\n    headers,\n    query\n  } = req;\n  const {\n    host\n  } = headers;\n  const {\n    id\n  } = query;\n  const result = await getExhibitionDetail(host, id);\n  res.statusCode = 200;\n  res.setHeader('Content-Type', 'application/json');\n  res.end(JSON.stringify(result));\n}\n\nexport default handler;","map":{"version":3,"sources":["/Users/luked/Documents/slnsw/dxlab-art-index/pages/api/art-index/exhibitions/[id].ts"],"names":["d3","getExhibitionDetail","host","id","allExhibitions","csv","exhibition","find","e","handler","req","res","headers","query","result","statusCode","setHeader","end","JSON","stringify"],"mappings":"AAAA,OAAO,KAAKA,EAAZ,MAAoB,IAApB;AAQA,OAAO,eAAeC,mBAAf,CACLC,IADK,EAELC,EAFK,EAG4B;AACjC;AACA,QAAMC,cAAwC,GAAG,MAAMJ,EAAE,CAACK,GAAH,CACpD,UAASH,IAAK,iCADsC,CAAvD;AAIA,QAAMI,UAAU,GAAGF,cAAc,CAACG,IAAf,CAAqBC,CAAD,IAAOA,CAAC,CAACL,EAAF,KAASA,EAApC,CAAnB;AAEA,SAAOG,UAAP;AACD;;AAED,eAAeG,OAAf,CAAuBC,GAAvB,EAA4CC,GAA5C,EAAkE;AAChE,QAAM;AAAEC,IAAAA,OAAF;AAAWC,IAAAA;AAAX,MAAqBH,GAA3B;AACA,QAAM;AAAER,IAAAA;AAAF,MAAWU,OAAjB;AACA,QAAM;AAAET,IAAAA;AAAF,MAASU,KAAf;AAEA,QAAMC,MAAM,GAAG,MAAMb,mBAAmB,CAACC,IAAD,EAAOC,EAAP,CAAxC;AAEAQ,EAAAA,GAAG,CAACI,UAAJ,GAAiB,GAAjB;AACAJ,EAAAA,GAAG,CAACK,SAAJ,CAAc,cAAd,EAA8B,kBAA9B;AACAL,EAAAA,GAAG,CAACM,GAAJ,CAAQC,IAAI,CAACC,SAAL,CAAeL,MAAf,CAAR;AACD;;AAED,eAAeL,OAAf","sourcesContent":["import * as d3 from 'd3';\nimport { NextApiRequest, NextApiResponse } from 'next';\n\nimport {\n  // ArtIndexApiQuery,\n  ArtIndexExhibitionType,\n} from '../../../../types/art-index-types';\n\nexport async function getExhibitionDetail(\n  host: string,\n  id: string,\n): Promise<ArtIndexExhibitionType> {\n  // TODO: Work out https or http\n  const allExhibitions: ArtIndexExhibitionType[] = await d3.csv(\n    `http://${host}/art-index/data/exhibitions.csv`,\n  );\n\n  const exhibition = allExhibitions.find((e) => e.id === id);\n\n  return exhibition;\n}\n\nasync function handler(req: NextApiRequest, res: NextApiResponse) {\n  const { headers, query } = req;\n  const { host } = headers;\n  const { id } = query;\n\n  const result = await getExhibitionDetail(host, id);\n\n  res.statusCode = 200;\n  res.setHeader('Content-Type', 'application/json');\n  res.end(JSON.stringify(result));\n}\n\nexport default handler;\n"]},"metadata":{},"sourceType":"module"}