{"ast":null,"code":"import * as d3 from 'd3';\nexport async function getArtistDetail(host, id) {\n  // TODO: Work out https or http\n  const allArtists = await d3.csv(`http://${host}/art-index/data/artists.csv`);\n  const artists = allArtists.find(a => a.id === id);\n  return artists;\n}\n\nasync function handler(req, res) {\n  const {\n    headers,\n    query\n  } = req;\n  const {\n    host\n  } = headers;\n  const {\n    id\n  } = query;\n  const result = await getArtistDetail(host, id);\n  res.statusCode = 200;\n  res.setHeader('Content-Type', 'application/json');\n  res.end(JSON.stringify(result));\n}\n\nexport default handler;","map":{"version":3,"sources":["/Users/luked/Documents/slnsw/dxlab-art-index/pages/api/art-index/artists/[id].ts"],"names":["d3","getArtistDetail","host","id","allArtists","csv","artists","find","a","handler","req","res","headers","query","result","statusCode","setHeader","end","JSON","stringify"],"mappings":"AAAA,OAAO,KAAKA,EAAZ,MAAoB,IAApB;AAQA,OAAO,eAAeC,eAAf,CACLC,IADK,EAELC,EAFK,EAGwB;AAC7B;AACA,QAAMC,UAAgC,GAAG,MAAMJ,EAAE,CAACK,GAAH,CAC5C,UAASH,IAAK,6BAD8B,CAA/C;AAIA,QAAMI,OAAO,GAAGF,UAAU,CAACG,IAAX,CAAiBC,CAAD,IAAOA,CAAC,CAACL,EAAF,KAASA,EAAhC,CAAhB;AAEA,SAAOG,OAAP;AACD;;AAED,eAAeG,OAAf,CAAuBC,GAAvB,EAA4CC,GAA5C,EAAkE;AAChE,QAAM;AAAEC,IAAAA,OAAF;AAAWC,IAAAA;AAAX,MAAqBH,GAA3B;AACA,QAAM;AAAER,IAAAA;AAAF,MAAWU,OAAjB;AACA,QAAM;AAAET,IAAAA;AAAF,MAASU,KAAf;AAEA,QAAMC,MAAM,GAAG,MAAMb,eAAe,CAACC,IAAD,EAAOC,EAAP,CAApC;AAEAQ,EAAAA,GAAG,CAACI,UAAJ,GAAiB,GAAjB;AACAJ,EAAAA,GAAG,CAACK,SAAJ,CAAc,cAAd,EAA8B,kBAA9B;AACAL,EAAAA,GAAG,CAACM,GAAJ,CAAQC,IAAI,CAACC,SAAL,CAAeL,MAAf,CAAR;AACD;;AAED,eAAeL,OAAf","sourcesContent":["import * as d3 from 'd3';\nimport { NextApiRequest, NextApiResponse } from 'next';\n\nimport {\n  // ArtIndexApiQuery,\n  ArtIndexArtistType,\n} from '../../../../types/art-index-types';\n\nexport async function getArtistDetail(\n  host: string,\n  id: string,\n): Promise<ArtIndexArtistType> {\n  // TODO: Work out https or http\n  const allArtists: ArtIndexArtistType[] = await d3.csv(\n    `http://${host}/art-index/data/artists.csv`,\n  );\n\n  const artists = allArtists.find((a) => a.id === id);\n\n  return artists;\n}\n\nasync function handler(req: NextApiRequest, res: NextApiResponse) {\n  const { headers, query } = req;\n  const { host } = headers;\n  const { id } = query;\n\n  const result = await getArtistDetail(host, id);\n\n  res.statusCode = 200;\n  res.setHeader('Content-Type', 'application/json');\n  res.end(JSON.stringify(result));\n}\n\nexport default handler;\n"]},"metadata":{},"sourceType":"module"}